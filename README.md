# My Black :[ROOTS] Dataset Builder  
A Genealogy + AI Dataset Builder for Black American Family Heritage

---

## Overview

**My Black :[ROOTS] Dataset Builder** is a browser-based application designed to help users preserve, explore, and analyze **Black American family heritage** with the support of advanced AI.  
It combines:

- Structured genealogy management  
- Deep relationship views  
- Haplogroup and enslaved-ancestor tracing  
- AI-assisted Q&A  
- Automatic dataset generation  
- Vector-based embeddings for search and refinement  
- A cultural feedback loop for improving model accuracy  

The system is built on **Supabase PostgreSQL**, with recursive SQL views, pgvector embeddings, robust RLS rules, and automated timestamp triggers.

This project powers the ‚ÄúMy Black :[ROOTS]‚Äù initiative, enabling users to build truthful, historically grounded family archives and generate training datasets for custom AI models like **gpt-oss:20b** and **gpt-oss:120b**.

---

## Key Features

### üß¨ Genealogy System
- Add, edit, and explore people and marriages  
- Track enslaved ancestors and DNA matches  
- Support for paternal/maternal haplogroups  
- Full ancestry and descendant tracing  
- Sibling, aunt/uncle, niece/nephew, and cousin detection  
- Autogenerated relationship labels  
- ‚ÄúHome Person‚Äù system for rooted family navigation  

### üìö Advanced Relationship Views  
The application uses multiple SQL views to compute relationships without requiring manual linking:

- `ancestry_relations`  
- `descendants_relations`  
- `lateral_relations`  
- `paternal_haplogroup_trace`  
- `maternal_haplogroup_trace`  
- `paternal_enslaved_trace`  
- `maternal_enslaved_trace`  

---

## ‚öôÔ∏è AI System Architecture

### Agent 1 ‚Äî Genealogy Q&A Agent  
- Reads from persons, marriages, and all relationship views  
- Uses feedback memory to prevent repeated errors  
- Generates historically accurate, culturally aware responses  

### Agent 2 ‚Äî Dataset Builder Agent  
- Generates dataset entries for AI training  
- Uses persons, marriages, all views, feedback, and chat history  
- Anonymizes content automatically  
- Saves results to Supabase and optionally Google Sheets  
- Produces vector embeddings (pgvector)  
- Supports refinement, deduplication, and versioning  

---

## üì¶ SQL Schema

The system includes:

### Core Tables
- `persons`  
- `marriages`

### AI Tables
- `dataset`  
- `feedback`  
- `chat_history`  
- `embeddings` (pgvector)

### Functions
- `update_timestamp()`  
- `enforce_single_home_person()`

### Triggers
- Auto-updating timestamps  
- Ensuring only one home person  
- Dataset version handling  

### Extensions
- `uuid-ossp`  
- `vector` (pgvector)

### Security
- Complete **Row Level Security (RLS)**  
- Public SELECT for genealogy  
- Authenticated INSERT/UPDATE for AI tables  

A full SQL bootstrap file is included in the repository.

---

## üß≠ Application Views

### Dashboard
Displays:
- Home Person  
- Ancestry / Descendant summaries  
- Lateral relations  
- Enslaved traces  
- Haplogroup traces  
- Dataset summary  
- Feedback summary  
- Agent 1 and Agent 2 chat panels  

### People View  
- Search, browse, edit persons  
- Manage parents, haplogroups, DNA, enslaved status  
- Set Home Person  
- Send person to Dataset Builder  

### Dataset View  
- Review dataset entries  
- Auto-generate examples with Agent 2  
- Export for fine-tuning  
- View embeddings  

### Feedback View  
- All user feedback  
- Inspect comments  
- Send to Agent 2 for dataset improvements  

### Settings  
- Database connection  
- Agent configuration  
- Light/Dark mode  

---

## üîÑ AI Feedback Loop

1. User chats with Agent 1  
2. User rates the response (thumbs up/down)  
3. Feedback saved  
4. Agent 2 generates improved dataset rows  
5. Embeddings update  
6. Future answers improve automatically  

This creates a long-term, self-correcting memory system.

---

## üß† Embeddings (pgvector)

The `embeddings` table stores:

- Linked dataset entry  
- Raw text  
- 768-dimension embedding vector  
- Timestamps  

An IVFFLAT index speeds similarity search and dataset refinement.

Agent 2 uses embeddings for:
- Deduplication  
- Context matching  
- Training example generation  
- Version-aware refinement  

---

## üõ† Technology Stack

- Supabase PostgreSQL  
- pgvector  
- Browser-based UI (TypeScript)  
- AI models (OpenAI gpt-oss or user-specified)  
- Google Sheets (optional mirror)  
- Optional n8n automation  

---

## üöÄ Mission

- Preserve **Black American family heritage** with accuracy  
- Provide culturally aware genealogical AI assistance  
- Create high-quality fine-tuning datasets  
- Build a durable, private historical archive  

---

## üìÅ Repository Structure

To be updated


