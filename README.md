# My Black :[ROOTS] Database Manager  
A Genealogy + AI Dataset Builder for Black American Family Heritage

---

## Overview

**My Black :[ROOTS] Database Manager** is a browser-based application designed to help users preserve, explore, and analyze **Black American family heritage** with the support of advanced AI.  
It combines:

- Structured genealogy management  
- Deep relationship views  
- Haplogroup and enslaved-ancestor tracing  
- AI-assisted Q&A  
- Automatic dataset generation  
- Vector-based embeddings for search and refinement  
- A cultural feedback loop for improving model accuracy  

The database is built on **Supabase PostgreSQL**, with recursive SQL views, pgvector embeddings, robust RLS rules, and automated timestamp triggers.

This project powers the ‚ÄúMy Black :[ROOTS]‚Äù initiative, enabling users to build truthful, historically grounded family archives and generate training datasets for custom AI models like **gpt-oss:20b** and **gpt-oss:120b**.

---

## Key Features

### üß¨ Genealogy System
- Add, edit, and explore people and marriages  
- Track enslaved ancestors and DNA matches  
- Support for paternal/maternal haplogroups  
- Full ancestry and descendant tracing  
- Sibling, aunt/uncle, niece/nephew, and cousin detection  
- Autogenerated relationship labels  
- ‚ÄúHome Person‚Äù system for rooted family navigation  

### üìö Advanced Relationship Views  
The application uses multiple SQL views to compute relationships without requiring manual linking:

- `ancestry_relations`  
- `descendants_relations`  
- `lateral_relations` (siblings, aunts/uncles, cousins, nieces/nephews)  
- `paternal_haplogroup_trace`  
- `maternal_haplogroup_trace`  
- `paternal_enslaved_trace`  
- `maternal_enslaved_trace`  

All views are fully recursive, dynamic, and aligned to the Home Person.

---

## ‚öôÔ∏è AI System Architecture

### Agent 1 ‚Äî Genealogy Q&A Agent  
- Reads from persons, marriages, and all relationship views  
- Incorporates user feedback as memory  
- Generates historically accurate, culturally aware responses  
- Avoids repeating past errors  

### Agent 2 ‚Äî Dataset Builder Agent  
- Generates dataset entries for AI training  
- Uses persons, marriages, all views, feedback, and chat history  
- Anonymizes content automatically  
- Stores examples in Supabase and optionally Google Sheets  
- Generates **vector embeddings** for similarity search  
- Enables refinement, deduplication, and versioning  

---

## üì¶ SQL Schema

The database includes:

### Core Tables
- `persons`  
- `marriages`

### AI Tables
- `dataset`  
- `feedback`  
- `chat_history`  
- `embeddings` (pgvector)

### Functions
- `update_timestamp()`  
- `enforce_single_home_person()`

### Triggers
- Auto-updating timestamps  
- Enforcing one home person  
- Dataset version tracking  

### Extensions
- `uuid-ossp`  
- `vector` (for pgvector embeddings)

### Security
- Full **Row Level Security (RLS)** for all core and AI tables  
- Public read allowed for genealogy views  
- Authenticated insert/update rules  

A full SQL bootstrap file is included in the repository.

---

## üß≠ Application Views

### Dashboard
Shows dynamic, data-driven summaries:
- Ancestry, descendants, lateral relations  
- Haplogroup and enslaved-ancestor traces  
- Dataset status  
- Feedback status  
- Chat panels for both agents  

### People View
- Full list of all persons  
- Search, edit, and relationship navigation  
- Set Home Person  
- Add to dataset  

### Dataset View
- Inspect dataset entries  
- Generate new examples using Agent 2  
- Export for fine-tuning  
- Track embeddings  

### Feedback View
- See user-submitted correctness ratings  
- Send items to Agent 2 for dataset refinement  

### Settings View
- Database connection  
- Agent configuration  
- Light/Dark mode  

---

## üîÑ AI Feedback Loop

The system uses a three-layer improvement cycle:

1. **User interacts with Agent 1**  
2. **User submits feedback** (thumbs up/down + comments)  
3. **Agent 2 refines dataset + embeddings**  
4. **Future answers improve automatically**

This creates a long-term, culturally consistent memory system.

---

## üß† Embeddings & Vector Search (pgvector)

The `embeddings` table stores:

- Dataset row association  
- Text content  
- A 768-dimension embedding vector  
- Timestamps  

An IVFFLAT index with `lists = 100` enables fast similarity search.

Agent 2 uses embeddings for:
- Deduplication  
- Smart dataset refinement  
- Similarity retrieval  
- Creating new examples based on related content  

---

## üõ† Technology Stack

- **Supabase PostgreSQL** (primary database)  
- **pgvector** (vector search)  
- **TypeScript + Browser UI** (client)  
- **AI Agents** (OpenAI / gpt-oss models via user-configurable settings)  
- **Google Sheets** (optional dataset mirror)  
- **n8n** (optional workflow automation)  

---

## üöÄ Goals of the Project

- Preserve Black American lineage with accuracy and respect  
- Provide culturally aware genealogical AI assistance  
- Generate high-quality datasets for custom model fine-tuning  
- Build a lasting, private archive of family history  
- Enable future generations to explore ancestry with clarity  

---

## üîê Privacy & Security

- All genealogy and feedback data remain under the user's control  
- No external storage without explicit configuration  
- RLS ensures correct access permissions  
- Demo mode available for safe onboarding  

---

## üìÅ Repository Contents


